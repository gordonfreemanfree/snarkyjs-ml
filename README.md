# snarkyjs-ml
This project provides a proof of concept for using machine learning models with zero-knowledge proofs. It demonstrates the use of zk-SNARKs in a machine learning context by implementing a neural network for handwritten digit recognition using the MNIST dataset. This neural network was completely implemented in zk-SNARK circuits using the SnarkyJS library. By using zk-SNARKs in this way, the prover can prove that they have drawn a certain handwritten image, which was then recognized by the neural network, without revealing the actual image itself. This could have potential applications in scenarios where privacy and security are important, such as proving that one is older than a certain age by presenting a photo of their passport without revealing sensitive personal information.

# Implementation

The weights of the neural network have been trained to be a positive value and were cropped to an integer value, so that they could be used as field elements. This was done to avoid the use of floating point numbers and negative values.
The prediction of the image is done within circuits, without recursion. We tried to max out the number of layers/neurons that could be run in a circuit.
The input shape of the original MNIST (28x28) was scaled down to (8x8). The reason for that is that bigger image sizes couldn't be run in the current circuit size. That leads to an accuracy of the model of about 90%.
We spend quite some time on optimizing the scaling factors of the weights and the input image. The scaling factors were chosen in a way that the weights and the input image are scaled to the same range. This way, the weights and the input image can be added and multiplied together without overflowing the field elements. This allows us to use almost only field elements which makes it efficient.
